<!doctype html>
<html lang="hr">

<head>
    <meta charset="UTF-8">
    <title>Vježbe</title>
    <script src="Persp.js"></script>
    <script src="MT3D.js"></script>
    <script>
        window.onload = start;

        function start() {
            var platno1 = document.getElementById("slika1");
            this.persp = new Persp(platno1, -18, 18, -18, 18, 10);
            this.mt = new MT3D();

            this.mt.postaviKameru(-5, -5, 8, 0, 0, 0, 1, 1, 1);
            this.persp.trans(this.mt);

            var rotacija = 0;
            function anim() {
                if (rotacija <= -360) {
                    rotacija = 0;
                }
                this.persp.pocistiPlatno();

                this.mt.identitet();
                this.persp.trans(this.mt);
                this.persp.koristiBoju("red");
                this.grid(7);

                this.mt.identitet();
                this.persp.trans(this.mt);
                this.persp.koristiBoju("black");
                this.persp.stozac(4, 6, 15);

                this.mt.identitet();
                this.mt.pomakni(0, 0, 5.3);
                this.mt.rotirajZ(toRad(-rotacija));
                this.persp.trans(this.mt);
                this.persp.valjak(0.5, 0.7, 16);

                this.mt.identitet();
                this.mt.rotirajY(toRad(90));
                this.mt.rotirajX(toRad(rotacija));
                this.mt.pomakni(-5.7, 0, 0.5);
                this.persp.trans(this.mt);
                this.persp.valjak(0.15, 2, 10);
                this.mt.pomakni(0, 0, 2.5);
                this.persp.trans(this.mt);
                //this.persp.kugla(0.5, 15, 5);

                requestAnimationFrame(anim);
                rotacija -= 6;
            }
            anim();
        }

        function grid(s) {
            for (let i = -s; i <= s + 1; i++) {
                for (let j = -s; j <= s + 1; j++) {
                    this.persp.postaviNa(i, j, 0);
                    this.persp.linijaDo(i + 1, j, 0);
                    this.persp.povuciLiniju();

                    this.persp.postaviNa(i + 1, j, 0);
                    this.persp.linijaDo(i + 1, j + 1, 0);
                    this.persp.povuciLiniju();

                    this.persp.postaviNa(i + 1, j + 1, 0);
                    this.persp.linijaDo(i, j + 1, 0);
                    this.persp.povuciLiniju();

                    this.persp.postaviNa(i, j + 1, 0);
                    this.persp.linijaDo(i, j, 0);
                    this.persp.povuciLiniju();
                }
            }
        }

        function toRad(deg) {
            return deg * Math.PI / 180;
        }
    </script>
</head>

<body>
    <h1>VJežbe</h1>
    <div>
        <canvas id="slika1" width="500" height="500" style="border:5px solid black">
            Vaš preglednik ne podržava HTML5 canvas.
        </canvas>
    </div>
</body>

</html>