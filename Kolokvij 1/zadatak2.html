<!DOCTYPE html>
<html lang="hr">

<head>
    <meta charset="UTF-8">
    <title>Čaša</title>
    <script src="MT3D.js"></script>
    <script src="Persp.js"></script>
    <script>
        window.onload = start;

        function start() {
            var platno = document.getElementById("slika");
            var udaljenost = 15;
            persp = new Persp(platno, -25, 25, -25, 25, udaljenost);
            mt = new MT3D();

            var pomak = 0;
            var gore = false;

            function rotacija() {
                persp.pocistiPlatno();

                mt.rotirajY(pretvoriURadijane(0.3));

                if (pomak > 15 && gore == true) {
                    gore = false;
                }
                if (pomak < 1 && gore == false) {
                    gore = true;
                }

                function mijenjajUdaljenost() {
                    if (gore == true) udaljenost = udaljenost + 0.1;
                    if (gore == false) udaljenost = udaljenost - 0.1;
                    return udaljenost;
                }

                if (gore == true) {
                    pomak = pomak + 0.05;
                }
                else {
                    pomak = pomak - 0.05;
                }
                mt.postaviKameru(10, pomak, 10, 1, 7, 1, 1, 1, 1);
                persp.promijeniUdaljenost(mijenjajUdaljenost());
                persp.trans(mt);

                nacrtajGrid(persp, 5, "red");
                persp.paramPloha(20, 20, "black");

                requestAnimationFrame(rotacija);
            }
            rotacija();
        }

        function nacrtajGrid(persp, duljina, boja) {
            for (let i = -duljina; i < duljina; i++) {
                for (let j = -duljina; j < duljina; j++) {
                    persp.koristiBoju(boja);

                    persp.postaviNa(i, 0, j);
                    persp.linijaDo(i + 1, 0, j);
                    persp.povuciLiniju();

                    persp.postaviNa(i + 1, 0, j);
                    persp.linijaDo(i + 1, 0, j + 1);
                    persp.povuciLiniju();

                    persp.postaviNa(i + 1, 0, j + 1);
                    persp.linijaDo(i, 0, j + 1);
                    persp.povuciLiniju();

                    persp.postaviNa(i, 0, j + 1);
                    persp.linijaDo(i, 0, j);
                    persp.povuciLiniju();
                }
            }
        }

        function pretvoriURadijane(deg) {
            return deg * Math.PI / 180;
        }
    </script>
</head>

<body>
    <h1>Čaša</h1>
    <div>
        <canvas id="slika" width="500" height="500" style="border:5px solid black">
            Vaš preglednik ne podržava HTML5 canvas.
        </canvas>
    </div>
</body>

</html>


<!-- paramPloha(uS, vS, boja) {
    var u_min = -1, u_max = 1;
    var v_min = 0, v_max = 2 * Math.PI;
    var u_step = (u_max - u_min) / uS;
    var v_step = (v_max - v_min) / vS;

    this.koristiBoju(boja);

    for (var u = u_min; u <= u_max; u += u_step) {
        for (var v = v_min; v <= v_max; v += v_step) {
            var x = u * Math.sin(v);
            var y = u * Math.cos(v);
            var z = Math.asin(Math.max(-1, Math.min(1, u)));
            if (u + u_step <= u_max) {
                var next_x = (u + u_step) * Math.sin(v);
                var next_y = (u + u_step) * Math.cos(v);
                var next_z = Math.asin(Math.max(-1, Math.min(1, u + u_step)));
                persp.postaviNa(x, y, z);
                persp.linijaDo(next_x, next_y, next_z);
                persp.povuciLiniju();
            }
            if (v + v_step <= v_max) {
                var next_x_v = u * Math.sin(v + v_step);
                var next_y_v = u * Math.cos(v + v_step);
                var next_z_v = z;
                persp.postaviNa(x, y, z);
                persp.linijaDo(next_x_v, next_y_v, next_z_v);
                persp.povuciLiniju();
            }
        }
    }
} -->